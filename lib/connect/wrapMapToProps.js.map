{"version":3,"sources":["../../src/connect/wrapMapToProps.js"],"names":["verifyPlainObject","require","wrapMapToPropsConstant","getConstant","initConstantSelector","dispatch","options","constant","constantSelector","dependsOnOwnProps","getDependsOnOwnProps","mapToProps","undefined","Boolean","length","wrapMapToPropsFunc","methodName","initProxySelector","displayName","proxy","mapToPropsProxy","stateOrDispatch","ownProps","detectFactoryAndVerify","props","module","exports"],"mappings":";;AAAA,IAAMA,oBAAoBC,QAAQ,4BAAR,CAA1B;;AAEA,SAASC,sBAAT,CAAgCC,WAAhC,EAA6C;AAC3C,SAAO,SAASC,oBAAT,CAA8BC,QAA9B,EAAwCC,OAAxC,EAAiD;AACtD,QAAMC,WAAWJ,YAAYE,QAAZ,EAAsBC,OAAtB,CAAjB;;AAEA,aAASE,gBAAT,GAA4B;AAAE,aAAOD,QAAP;AAAiB;AAC/CC,qBAAiBC,iBAAjB,GAAqC,KAArC;AACA,WAAOD,gBAAP;AACD,GAND;AAOD;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASE,oBAAT,CAA8BC,UAA9B,EAA0C;AACxC,SAAQA,WAAWF,iBAAX,KAAiC,IAAjC,IAAyCE,WAAWF,iBAAX,KAAiCG,SAA3E,GACHC,QAAQF,WAAWF,iBAAnB,CADG,GAEHE,WAAWG,MAAX,KAAsB,CAF1B;AAGD;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,kBAAT,CAA4BJ,UAA5B,EAAwCK,UAAxC,EAAoD;AAClD,SAAO,SAASC,iBAAT,CAA2BZ,QAA3B,QAAsD;AAAA,QAAfa,WAAe,QAAfA,WAAe;;AAC3D,QAAMC,QAAQ,SAASC,eAAT,CAAyBC,eAAzB,EAA0CC,QAA1C,EAAoD;AAChE,aAAOH,MAAMV,iBAAN,GACHU,MAAMR,UAAN,CAAiBU,eAAjB,EAAkCC,QAAlC,CADG,GAEHH,MAAMR,UAAN,CAAiBU,eAAjB,CAFJ;AAGD,KAJD;;AAMA;AACAF,UAAMV,iBAAN,GAA0B,IAA1B;;AAEAU,UAAMR,UAAN,GAAmB,SAASY,sBAAT,CAAgCF,eAAhC,EAAiDC,QAAjD,EAA2D;AAC5EH,YAAMR,UAAN,GAAmBA,UAAnB;AACAQ,YAAMV,iBAAN,GAA0BC,qBAAqBC,UAArB,CAA1B;AACA,UAAIa,QAAQL,MAAME,eAAN,EAAuBC,QAAvB,CAAZ;;AAEA,UAAI,OAAOE,KAAP,KAAiB,UAArB,EAAiC;AAC/BL,cAAMR,UAAN,GAAmBa,KAAnB;AACAL,cAAMV,iBAAN,GAA0BC,qBAAqBc,KAArB,CAA1B;AACAA,gBAAQL,MAAME,eAAN,EAAuBC,QAAvB,CAAR;AACD;;AAED;AACA;;AAEA,aAAOE,KAAP;AACD,KAfD;;AAiBA,WAAOL,KAAP;AACD,GA5BD;AA6BD;;AAEDM,OAAOC,OAAP,GAAiB;AACfxB,gDADe;AAEfQ,4CAFe;AAGfK;AAHe,CAAjB","file":"wrapMapToProps.js","sourcesContent":["const verifyPlainObject = require('../utils/verifyPlainObject')\n\nfunction wrapMapToPropsConstant(getConstant) {\n  return function initConstantSelector(dispatch, options) {\n    const constant = getConstant(dispatch, options)\n\n    function constantSelector() { return constant }\n    constantSelector.dependsOnOwnProps = false \n    return constantSelector\n  }\n}\n\n// dependsOnOwnProps is used by createMapToPropsProxy to determine whether to pass props as args\n// to the mapToProps function being wrapped. It is also used by makePurePropsSelector to determine\n// whether mapToProps needs to be invoked when props have changed.\n// \n// A length of one signals that mapToProps does not depend on props from the parent component.\n// A length of zero is assumed to mean mapToProps is getting args via arguments or ...args and\n// therefore not reporting its length accurately..\nfunction getDependsOnOwnProps(mapToProps) {\n  return (mapToProps.dependsOnOwnProps !== null && mapToProps.dependsOnOwnProps !== undefined)\n    ? Boolean(mapToProps.dependsOnOwnProps)\n    : mapToProps.length !== 1\n}\n\n// Used by whenMapStateToPropsIsFunction and whenMapDispatchToPropsIsFunction,\n// this function wraps mapToProps in a proxy function which does several things:\n// \n//  * Detects whether the mapToProps function being called depends on props, which\n//    is used by selectorFactory to decide if it should reinvoke on props changes.\n//    \n//  * On first call, handles mapToProps if returns another function, and treats that\n//    new function as the true mapToProps for subsequent calls.\n//    \n//  * On first call, verifies the first result is a plain object, in order to warn\n//    the developer that their mapToProps function is not returning a valid result.\n//    \nfunction wrapMapToPropsFunc(mapToProps, methodName) {\n  return function initProxySelector(dispatch, { displayName }) {\n    const proxy = function mapToPropsProxy(stateOrDispatch, ownProps) {\n      return proxy.dependsOnOwnProps\n        ? proxy.mapToProps(stateOrDispatch, ownProps)\n        : proxy.mapToProps(stateOrDispatch)\n    }\n\n    // allow detectFactoryAndVerify to get ownProps\n    proxy.dependsOnOwnProps = true\n\n    proxy.mapToProps = function detectFactoryAndVerify(stateOrDispatch, ownProps) {\n      proxy.mapToProps = mapToProps\n      proxy.dependsOnOwnProps = getDependsOnOwnProps(mapToProps)\n      let props = proxy(stateOrDispatch, ownProps)\n\n      if (typeof props === 'function') {\n        proxy.mapToProps = props\n        proxy.dependsOnOwnProps = getDependsOnOwnProps(props)\n        props = proxy(stateOrDispatch, ownProps)\n      }\n\n      // if (process.env.NODE_ENV !== 'production') \n      //   verifyPlainObject(props, displayName, methodName)\n\n      return props\n    }\n\n    return proxy\n  }\n}\n\nmodule.exports = {\n  wrapMapToPropsConstant,\n  getDependsOnOwnProps,\n  wrapMapToPropsFunc\n} "]}